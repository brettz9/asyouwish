<!DOCTYPE html>
<html><head><meta charset="utf-8" />
<script>

window.addEventListener('DOMContentLoaded', function () {

    var errBack = function (error) {
        document.getElementById('errs').
            appendChild(document.createTextNode('Error type: ' + error + '\n'));
        document.getElementById('errs').
            appendChild(document.createElement('br'));
    };
    // errBack = false; // Try default (only alerts when refused)

    try {
        
        AsYouWish.requestPrivs('xhr', function (xhr) {
            var x = new xhr.XMLHttpRequest();
            x.open('GET', 'http://mozilla.org/', false);
            x.send(null);
            alert(x.responseText);

            // We don't want to trigger request twice, so we wait until callback returns.
            AsYouWish.requestPrivs('url', function (URLObj) {
                alert(
                    URLObj.fromFilename('C:\\')
                );
                alert(
                    URLObj.toFilename('file:///C:/')
                );
                
                var url = URLObj.URL('http://example.com/');
                
                alert(url);
                alert(url.scheme);
            }, errBack);
            
        }, errBack);
        
    } catch (e) {
        alert('page error: ' + e);
    }
});

</script>
</head><body>

<div id="errs"></div>

</body></html>